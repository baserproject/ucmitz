{"version":3,"file":"admin/contents/index.bundle.js","mappings":";AAcAA,GAAE,YAOE,SAAkBC,GAEd,IAAIC,EAAWF,EAAE,gDAAgDG,MAC7DC,EAAOJ,EAAE,qBAAqBG,WACjBE,IAAbH,GAAmC,UAATE,IAC1BF,EAAW,KAIf,IAiGII,EAjGAC,EAAyBP,EAAE,2BAC/B,OAAQE,GACJ,IAAK,IA+FLI,EAAaN,EAAE,6BACnBA,EAAEQ,OAAOC,KAAK,CACVC,QAASJ,EAAWK,KAAK,gBACzBC,kBAAmBN,EAAWK,KAAK,0BACnCE,YAAaP,EAAWK,KAAK,oBAC7BG,gBAAiBR,EAAWK,KAAK,wBACjCI,oBAAqBT,EAAWK,KAAK,8BAGzCX,EAAEgB,QAAQC,KAAK,YAAajB,EAAEQ,OAAOU,4BACrClB,EAAE,gBAAgBmB,OAAM,WACpBnB,EAAEQ,OAAOY,OAAOC,cAEpBrB,EAAE,iBAAiBmB,OAAM,WACrBnB,EAAEQ,OAAOY,OAAOE,YAChBtB,EAAEQ,OAAOY,OAAOG,UAAUvB,EAAEQ,OAAOY,OAAOI,YAAY,GAAO,MAGjExB,EAAE,kBAAkBmB,MAAMnB,EAAEQ,OAAOiB,iBAGnCzB,EAAE0B,UAAUC,GAAG,kBAAmB3B,EAAEQ,OAAOoB,cAC3C5B,EAAE0B,UAAUC,GAAG,mBAAoB3B,EAAEQ,OAAOqB,iBAC5C7B,EAAE8B,OAAOC,qBAAsB,EAC/B/B,EAAEA,EAAEQ,QAAQS,KAAK,UAAU,WACvBjB,EAAE8B,OAAOC,qBAAsB,KAEnC/B,EAAEQ,OAAOwB,OAxHDzB,EAAuB0B,OACvB,MACJ,IAAK,IAEDjC,EAAEkC,QAAQzB,KAAK,CAAC0B,SAAUnC,EAAE8B,OAAOM,aAATpC,8BAC1BO,EAAuB8B,OAK/B,IAAIC,EAAYtC,EAAE,WACcA,EAAE,oBAAoBuC,OAElDD,EAAUL,OAEVK,EAAUD,OAiCdrC,EAAE,wCAAwCwC,QAAO,WAE7C,OADAxC,EAAE8B,OAAOW,aACDzC,EAAE,gDAAgDG,OACtD,IAAK,IAmCbuC,SAASC,KAAOD,SAASC,KAAKC,QAAQ,cAAe,eAAeA,QAAQ,iBAAkB,IAAIA,QAAQ,KAAM,IAjCpG,MACJ,IAAK,IAYPC,EAAkB,IAAIC,gBAAgB9B,OAAO0B,SAASK,QASxDC,EAPJ,UADeC,OAAOC,YAAYL,EAAgBM,WACpCC,eAAd,QAAyB,EAQrBC,EAAMrD,EAAE8B,OAAOM,aAATpC,qCAAoEgD,EAC1EM,EAAcC,UAAUvD,EAAE,qBAAqBwD,aACnDd,SAASC,KAAOU,EAAM,IAAMC,EAJhC,IACQN,EACAK,EACAC,EAZoB,EAClBT,KApFVY","sources":["webpack://bc-admin-third/./webroot/js/src/admin/contents/index.js"],"sourcesContent":["/**\n * baserCMS :  Based Website Development Project <https://basercms.net>\n * Copyright (c) NPO baser foundation <https://baserfoundation.org/>\n *\n * @copyright     Copyright (c) NPO baser foundation\n * @link          https://basercms.net baserCMS Project\n * @since         5.0.0\n * @license       https://basercms.net/license/index.html MIT License\n */\n\n/**\n * コンテンツ一覧\n */\n\n$(function () {\n\n    initView();\n\n    /**\n     * 表示初期化\n     */\n    function initView(e) {\n\n        let listType = $(\"input[name='ViewSetting[list_type]']:checked\").val();\n        let mode = $(\"#viewsetting-mode\").val();\n        if (listType === undefined || mode === 'trash') {\n            listType = \"1\";\n        }\n\n        // 一覧\n        let grpChangeTreeOpenClose = $(\"#GrpChangeTreeOpenClose\");\n        switch (listType) {\n            case \"1\":\n                initTree()\n                grpChangeTreeOpenClose.show();\n                break;\n            case \"2\":\n                // 一括処理\n                $.bcBatch.init({batchUrl: $.bcUtil.adminBaseUrl + 'baser-core' + '/contents/batch'});\n                grpChangeTreeOpenClose.hide();\n                break;\n        }\n\n        // 検索ボックス\n        let searchBox = $(\"#Search\");\n        let contentsIndexSearchOpened = $(\"#SearchBoxOpened\").html();\n        if (contentsIndexSearchOpened) {\n            searchBox.show();\n        } else {\n            searchBox.hide();\n        }\n\n        // サイトが変わった場合は検索ボックスをリセット\n        if (e !== undefined && e.target.id === 'viewsetting-site-id') {\n            $(\"#BtnSearchClear\").click();\n            $.ajax({\n                url: $.bcUtil.apiBaseUrl + 'baser-core/contents/get_content_folder_list/' + $(this).val(),\n                headers: {\n                    \"Authorization\": $.bcJwt.accessToken,\n                },\n                type: \"GET\",\n                dataType: \"json\",\n                beforeSend: function () {\n                    $(\"#ContentFolderId\").prop('disabled', true);\n                },\n                complete: function () {\n                    $(\"#ContentFolderId\").removeAttr(\"disabled\");\n                },\n                success: function (result) {\n                    let contentFolderId = $(\"#ContentFolderId\");\n                    contentFolderId.empty();\n                    let optionItems = [];\n                    optionItems.push(new Option(\"指定なし\", \"\"));\n                    for (key in result) {\n                        optionItems.push(new Option(result.list[key].replace(/&nbsp;/g, \"\\u00a0\"), key));\n                    }\n                    contentFolderId.append(optionItems);\n                }\n            });\n        }\n\n        // 表示変更時\n        $(\"input[name='ViewSetting[list_type]']\").change(() => {\n            $.bcUtil.showLoader();\n            switch ($(\"input[name='ViewSetting[list_type]']:checked\").val()) {\n                case \"1\":\n                    loadTree()\n                    break;\n                case \"2\":\n                    loadTable();\n                    break;\n            }\n        });\n    }\n\n    /**\n     * 現在のサイトIDを取得\n     * @returns {string|number}\n     */\n    function getCurrentSiteId() {\n        const urlSearchParams = new URLSearchParams(window.location.search);\n        const params = Object.fromEntries(urlSearchParams.entries());\n        return params.site_id ?? 1;\n    }\n\n    /**\n     * 表形式のリストをロードする\n     */\n    function loadTable() {\n        let siteId = getCurrentSiteId();\n        let url = $.bcUtil.adminBaseUrl + 'baser-core' + '/contents/index?site_id=' + siteId;\n        let queryParams = decodeURI($(\"#ContentIndexForm\").serialize());\n        location.href = url + '&' + queryParams;\n    }\n\n    /**\n     * ツリーを読み込む\n     */\n    function loadTree() {\n        // listTypeを変更し、空のクエリ文字列を消す処理\n        location.href = location.href.replace(\"list_type=2\", \"list_type=1\").replace(/[^?=&]+=(&|$)/g, \"\").replace(/&$/, \"\");\n    }\n\n    /**\n     * ツリーの初期化\n     */\n    function initTree() {\n        let scriptData = $(\"#AdminContentsIndexScript\");\n        $.bcTree.init({\n            isAdmin: scriptData.attr('data-isAdmin'),\n            isUseMoveContents: scriptData.attr('data-isUseMoveContents'),\n            adminPrefix: scriptData.attr('data-adminPrefix'),\n            baserCorePrefix: scriptData.attr('data-baserCorePrefix'),\n            editInIndexDisabled: scriptData.attr('data-editInIndexDisabled'),\n        });\n        // マウスダウンイベント\n        $(window).bind(\"mousedown\", $.bcTree.updateShiftAndCtrlOnAnchor);\n        $(\"#BtnOpenTree\").click(function () {\n            $.bcTree.jsTree.open_all();\n        });\n        $(\"#BtnCloseTree\").click(function () {\n            $.bcTree.jsTree.close_all();\n            $.bcTree.jsTree.open_node($.bcTree.jsTree.get_json(), false, false);\n        });\n        // 新規追加クリック時\n        $(\"#BtnAddContent\").click($.bcTree.showMenuByOuter);\n\n        // ドラッグ＆ドロップイベント\n        $(document).on(\"dnd_stop.vakata\", $.bcTree.orderContent);\n        $(document).on(\"dnd_start.vakata\", $.bcTree.changeDnDCursor);\n        $.bcUtil.disabledHideMessage = true;\n        $($.bcTree).bind('loaded', function () {\n            $.bcUtil.disabledHideMessage = false;\n        });\n        $.bcTree.load();\n    }\n});\n"],"names":["$","e","listType","val","mode","undefined","scriptData","grpChangeTreeOpenClose","bcTree","init","isAdmin","attr","isUseMoveContents","adminPrefix","baserCorePrefix","editInIndexDisabled","window","bind","updateShiftAndCtrlOnAnchor","click","jsTree","open_all","close_all","open_node","get_json","showMenuByOuter","document","on","orderContent","changeDnDCursor","bcUtil","disabledHideMessage","load","show","bcBatch","batchUrl","adminBaseUrl","hide","searchBox","html","change","showLoader","location","href","replace","urlSearchParams","URLSearchParams","search","siteId","Object","fromEntries","entries","site_id","url","queryParams","decodeURI","serialize","initView"],"sourceRoot":""}
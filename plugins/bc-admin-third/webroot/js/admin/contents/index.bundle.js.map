{"version":3,"file":"js/admin/contents/index.bundle.js","mappings":";;;;;;;;;AAcAA,GAAE,YAOE,SAAkBC,GAEd,IAAIC,EAAWF,EAAE,gDAAgDG,MAC7DC,EAAOJ,EAAE,qBAAqBG,WACjBE,IAAbH,GAAmC,UAATE,IAC1BF,EAAW,KAIf,IA2FII,EA3FAC,EAAyBP,EAAE,2BAC/B,OAAQE,GACJ,IAAK,IAyFLI,EAAaN,EAAE,6BACnBA,EAAEQ,OAAOC,KAAK,CACVC,QAASJ,EAAWK,KAAK,gBACzBC,kBAAmBN,EAAWK,KAAK,0BACnCE,YAAaP,EAAWK,KAAK,oBAC7BG,gBAAiBR,EAAWK,KAAK,wBACjCI,oBAAqBT,EAAWK,KAAK,8BAGzCX,EAAEgB,QAAQC,KAAK,YAAajB,EAAEQ,OAAOU,4BACrClB,EAAE,gBAAgBmB,OAAM,WACpBnB,EAAEQ,OAAOY,OAAOC,UACpB,IACArB,EAAE,iBAAiBmB,OAAM,WACrBnB,EAAEQ,OAAOY,OAAOE,YAChBtB,EAAEQ,OAAOY,OAAOG,UAAUvB,EAAEQ,OAAOY,OAAOI,YAAY,GAAO,EACjE,IAEAxB,EAAE,kBAAkBmB,MAAMnB,EAAEQ,OAAOiB,iBAGnCzB,EAAE0B,UAAUC,GAAG,kBAAmB3B,EAAEQ,OAAOoB,cAC3C5B,EAAE0B,UAAUC,GAAG,mBAAoB3B,EAAEQ,OAAOqB,iBAC5C7B,EAAE8B,OAAOC,qBAAsB,EAC/B/B,EAAEA,EAAEQ,QAAQS,KAAK,UAAU,WACvBjB,EAAE8B,OAAOC,qBAAsB,CACnC,IACA/B,EAAEQ,OAAOwB,OAlHDzB,EAAuB0B,OACvB,MACJ,IAAK,IAEDjC,EAAEkC,QAAQzB,KAAK,CAAC0B,SAAUnC,EAAE8B,OAAOM,gBAATpC,mCAC1BO,EAAuB8B,OAI/BrC,EAAE,oBAAoBmB,OAAM,WAExB,OADAnB,EAAE,cAAcG,IAAI,IACb,CACX,SAGUE,IAANJ,GAAmC,wBAAhBA,EAAEqC,OAAOC,KAC5BvC,EAAE,mBAAmBmB,QACrBnB,EAAEwC,KAAK,CACHC,IAAKzC,EAAE8B,OAAOM,gBAAkB,+CAAiDpC,EAAE0C,MAAMvC,MACzFwC,QAAS,CACL,cAAiB3C,EAAE4C,MAAMC,aAE7BC,KAAM,MACNC,SAAU,OACVC,WAAY,WACRhD,EAAE,oBAAoBiD,KAAK,YAAY,EAC3C,EACAC,SAAU,WACNlD,EAAE,oBAAoBmD,WAAW,WACrC,EACAC,QAAS,SAAUC,GACf,IAAIC,EAAkBtD,EAAE,oBACxBsD,EAAgBC,QAChB,IAAIC,EAAc,GAElB,IAAKC,OADLD,EAAYE,KAAK,IAAIC,OAAO,OAAQ,KACxBN,EACRG,EAAYE,KAAK,IAAIC,OAAON,EAAOO,KAAKH,KAAKI,QAAQ,UAAW,KAAWJ,MAE/EH,EAAgBQ,OAAON,EAC3B,KAKRxD,EAAE,wCAAwC+D,QAAO,WAE7C,OADA/D,EAAE8B,OAAOkC,aACDhE,EAAE,gDAAgDG,OACtD,IAAK,IAiCb8D,SAASC,KAAOlE,EAAE8B,OAAOqC,aAATnE,wCA/BJ,MACJ,IAAK,IAqBTyC,EAAMzC,EAAE8B,OAAOqC,aAATnE,6BACVA,EAAE,cAAcG,IAAI,GACpB8D,SAASC,KAAOzB,EAAM2B,UAAUpE,EAAE,qBAAqBqE,aAH3D,IACQ5B,CAjBJ,GACJ,CAzEA6B,EAsIJ","sources":["webpack://bc-admin-third/./src/js/admin/contents/index.js"],"sourcesContent":["/**\n * baserCMS :  Based Website Development Project <https://basercms.net>\n * Copyright (c) NPO baser foundation <https://baserfoundation.org/>\n *\n * @copyright     Copyright (c) NPO baser foundation\n * @link          https://basercms.net baserCMS Project\n * @since         5.0.0\n * @license       https://basercms.net/license/index.html MIT License\n */\n\n/**\n * コンテンツ一覧\n */\n\n$(function () {\n\n    initView();\n\n    /**\n     * 表示初期化\n     */\n    function initView(e) {\n\n        let listType = $(\"input[name='ViewSetting[list_type]']:checked\").val();\n        let mode = $(\"#viewsetting-mode\").val();\n        if (listType === undefined || mode === 'trash') {\n            listType = \"1\";\n        }\n\n        // 一覧\n        let grpChangeTreeOpenClose = $(\"#GrpChangeTreeOpenClose\");\n        switch (listType) {\n            case \"1\":\n                initTree()\n                grpChangeTreeOpenClose.show();\n                break;\n            case \"2\":\n                // 一括処理\n                $.bcBatch.init({batchUrl: $.bcUtil.apiAdminBaseUrl + 'baser-core' + '/contents/batch.json'});\n                grpChangeTreeOpenClose.hide();\n                break;\n        }\n\n        $(\"#BtnSearchSubmit\").click(function (){\n            $(\"#list-type\").val(2);\n            return true;\n        });\n\n        // サイトが変わった場合は検索ボックスをリセット\n        if (e !== undefined && e.target.id === 'viewsetting-site-id') {\n            $(\"#BtnSearchClear\").click();\n            $.ajax({\n                url: $.bcUtil.apiAdminBaseUrl + 'baser-core/contents/get_content_folder_list/' + $(this).val(),\n                headers: {\n                    \"Authorization\": $.bcJwt.accessToken,\n                },\n                type: \"GET\",\n                dataType: \"json\",\n                beforeSend: function () {\n                    $(\"#ContentFolderId\").prop('disabled', true);\n                },\n                complete: function () {\n                    $(\"#ContentFolderId\").removeAttr(\"disabled\");\n                },\n                success: function (result) {\n                    let contentFolderId = $(\"#ContentFolderId\");\n                    contentFolderId.empty();\n                    let optionItems = [];\n                    optionItems.push(new Option(\"指定なし\", \"\"));\n                    for (key in result) {\n                        optionItems.push(new Option(result.list[key].replace(/&nbsp;/g, \"\\u00a0\"), key));\n                    }\n                    contentFolderId.append(optionItems);\n                }\n            });\n        }\n\n        // 表示変更時\n        $(\"input[name='ViewSetting[list_type]']\").change(() => {\n            $.bcUtil.showLoader();\n            switch ($(\"input[name='ViewSetting[list_type]']:checked\").val()) {\n                case \"1\":\n                    loadTree()\n                    break;\n                case \"2\":\n                    loadTable();\n                    break;\n            }\n        });\n    }\n\n    /**\n     * 現在のサイトIDを取得\n     * @returns {string|number}\n     */\n    function getCurrentSiteId() {\n        const urlSearchParams = new URLSearchParams(window.location.search);\n        const params = Object.fromEntries(urlSearchParams.entries());\n        return params.site_id ?? 1;\n    }\n\n    /**\n     * 表形式のリストをロードする\n     */\n    function loadTable() {\n        let url = $.bcUtil.adminBaseUrl + 'baser-core' + '/contents/index?';\n        $(\"#list-type\").val(2);\n        location.href = url + decodeURI($(\"#ContentIndexForm\").serialize());\n    }\n\n    /**\n     * ツリーを読み込む\n     */\n    function loadTree() {\n        location.href = $.bcUtil.adminBaseUrl + 'baser-core' + '/contents/index?list_type=1';\n    }\n\n    /**\n     * ツリーの初期化\n     */\n    function initTree() {\n        let scriptData = $(\"#AdminContentsIndexScript\");\n        $.bcTree.init({\n            isAdmin: scriptData.attr('data-isAdmin'),\n            isUseMoveContents: scriptData.attr('data-isUseMoveContents'),\n            adminPrefix: scriptData.attr('data-adminPrefix'),\n            baserCorePrefix: scriptData.attr('data-baserCorePrefix'),\n            editInIndexDisabled: scriptData.attr('data-editInIndexDisabled'),\n        });\n        // マウスダウンイベント\n        $(window).bind(\"mousedown\", $.bcTree.updateShiftAndCtrlOnAnchor);\n        $(\"#BtnOpenTree\").click(function () {\n            $.bcTree.jsTree.open_all();\n        });\n        $(\"#BtnCloseTree\").click(function () {\n            $.bcTree.jsTree.close_all();\n            $.bcTree.jsTree.open_node($.bcTree.jsTree.get_json(), false, false);\n        });\n        // 新規追加クリック時\n        $(\"#BtnAddContent\").click($.bcTree.showMenuByOuter);\n\n        // ドラッグ＆ドロップイベント\n        $(document).on(\"dnd_stop.vakata\", $.bcTree.orderContent);\n        $(document).on(\"dnd_start.vakata\", $.bcTree.changeDnDCursor);\n        $.bcUtil.disabledHideMessage = true;\n        $($.bcTree).bind('loaded', function () {\n            $.bcUtil.disabledHideMessage = false;\n        });\n        $.bcTree.load();\n    }\n});\n"],"names":["$","e","listType","val","mode","undefined","scriptData","grpChangeTreeOpenClose","bcTree","init","isAdmin","attr","isUseMoveContents","adminPrefix","baserCorePrefix","editInIndexDisabled","window","bind","updateShiftAndCtrlOnAnchor","click","jsTree","open_all","close_all","open_node","get_json","showMenuByOuter","document","on","orderContent","changeDnDCursor","bcUtil","disabledHideMessage","load","show","bcBatch","batchUrl","apiAdminBaseUrl","hide","target","id","ajax","url","this","headers","bcJwt","accessToken","type","dataType","beforeSend","prop","complete","removeAttr","success","result","contentFolderId","empty","optionItems","key","push","Option","list","replace","append","change","showLoader","location","href","adminBaseUrl","decodeURI","serialize","initView"],"sourceRoot":""}
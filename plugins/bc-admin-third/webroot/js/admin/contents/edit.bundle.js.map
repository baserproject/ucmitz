{"version":3,"file":"js/admin/contents/edit.bundle.js","mappings":"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","sources":["webpack://bc-admin-third/./src/js/admin/contents/edit.js"],"sourcesContent":["/**\n * baserCMS :  Based Website Development Project <https://basercms.net>\n * Copyright (c) NPO baser foundation <https://baserfoundation.org/>\n *\n * @copyright     Copyright (c) NPO baser foundation\n * @link          https://basercms.net baserCMS Project\n * @since         5.0.0\n * @license       https://basercms.net/license/index.html MIT License\n */\n\n/**\n * コンテンツ編集\n */\n\n$(function () {\n    window.setTimeout(function () {\n        window.scrollTo(0, 1);\n    }, 100);\n    var fullUrl = $(\"#AdminContentsEditScript\").attr('data-fullurl');\n    var previewurlBase = $(\"#AdminContentsEditScript\").attr('data-previewurl');\n    var current = $.parseJSON($(\"#AdminContentsEditScript\").attr('data-current'));\n    var bcManageContent = $.parseJSON($(\"#AdminContentsEditScript\").attr('data-settings'));\n\n    $(\"form #ContentsFormTabs\").tabs().show();\n\n    $(\"#BtnSave\").click(function () {\n        $.bcUtil.showLoader();\n    });\n\n    $(\"#BtnPreview\").click(function () {\n        window.open('', 'preview');\n        var form = $(this).parents('form');\n        var action = form.attr('action');\n        var previewMode = $(\"#ContentPreviewMode\").val();\n        var previewurl = previewurlBase;\n\n        if ($(\"#ContentAliasId\").val()) {\n            previewMode = 'alias';\n        }\n        if (previewurl.match(/\\?/)) {\n            previewurl += '&url=' + fullUrl +  '&preview=' + previewMode;\n        } else {\n            previewurl += '?url=' + fullUrl + '&preview=' + previewMode;\n        }\n\n        form.attr('target', 'preview');\n        form.attr('action', previewurl);\n        form.submit();\n        form.attr('target', '_self');\n        form.attr('action', action);\n        $.get($.bcUtil.baseUrl + '/baser-core/bc_form/get_token?requestview=false', function (result) {\n            $('input[name=\"_csrfToken\"]').val(result);\n        });\n        return false;\n    });\n\n    $(\"#BtnDelete\").click(function () {\n        var message = bcI18n.contentsEditConfirmMessage1;\n        if ($(\"#ContentAliasId\").val()) {\n            message = bcI18n.contentsEditConfirmMessage2;\n        }\n        if (confirm(message)) {\n            $(\"#BtnDelete\").prop(\"disabled\", true);\n            $.bcUtil.showLoader();\n            var form = $(this).parents('form');\n            form.attr('action', $.bcUtil.adminBaseUrl + 'baser-core' + '/contents/delete');\n            form.submit();\n        }\n        return false;\n    });\n\n    $(\".create-alias\").click(function () {\n        var siteId = $(this).attr('data-site-id');\n        var displayName = $(\"#sites-display-name\" + siteId).val();\n        var targetUrl = $(\"#sites-target-url\" + siteId).val();\n        var data = {\n            content: {\n                title: current.name,\n                plugin: current.plugin,\n                type: current.type,\n                site_id: siteId,\n                alias_id: current.id,\n                entity_id: current.entity_id,\n                url: current.url\n            }\n        };\n        if (confirm(bcI18n.contentsEditConfirmMessage3.sprintf(displayName))) {\n            $.bcToken.check(function () {\n                return $.ajax({\n                    url: $.bcUtil.apiAdminBaseUrl + 'baser-core/contents/is_unique_content',\n                    headers: {\n                        \"Authorization\": $.bcJwt.accessToken,\n                    },\n                    type: 'POST',\n                    data: {\n                        url: targetUrl,\n                        _csrfToken: $.bcToken.key,\n                    },\n                    beforeSend: function () {\n                        $.bcUtil.showLoader();\n                    },\n                    success: function (result) {\n                        if (result) {\n                            $.bcToken.key = null;\n                            $.bcToken.check(function () {\n                                return $.ajax({\n                                    url: bcManageContent['ContentAlias']['url']['add'],\n                                    headers: {\n                                        \"Authorization\": $.bcJwt.accessToken,\n                                    },\n                                    type: 'POST',\n                                    data: $.extend(data, {\n                                        _csrfToken: $.bcToken.key,\n                                    }),\n                                    dataType: 'json',\n                                    beforeSend: function () {\n                                        $(\"#Waiting\").show();\n                                    },\n                                    success: function (result) {\n                                        $.bcUtil.hideLoader();\n                                        location.hash = '#Page';\n                                        $.bcUtil.showNoticeMessage(bcI18n.contentsEditInfoMessage1);\n                                        location.href = $.bcUtil.adminBaseUrl + 'baser-core' +  '/contents/edit_alias/' + result.content.id;\n                                    },\n                                    error: function (XMLHttpRequest, textStatus, errorThrown) {\n                                        $.bcUtil.hideLoader();\n                                        $.bcUtil.showAlertMessage(bcI18n.contentsEditAlertMessage1);\n                                        $.bcToken.key = null;\n                                    }\n                                });\n                            }, {useUpdate: false, hideLoader: false});\n                        } else {\n                            $.bcUtil.hideLoader();\n                            $.bcUtil.showAlertMessage(bcI18n.contentsEditAlertMessage2);\n                        }\n                    },\n                    error: function (XMLHttpRequest, textStatus, errorThrown) {\n                        $.bcUtil.hideLoader();\n                        $.bcUtil.showAlertMessage(bcI18n.contentsEditAlertMessage1);\n                    }\n                });\n            }, {useUpdate: false, hideLoader: false});\n\n        }\n        return false;\n    });\n\n    $(\".create-copy\").click(function () {\n        var siteId = $(this).attr('data-site-id');\n        var displayName = $(\"#sites-display-name\" + siteId).val();\n        var targetUrl = $(\"#sites-target-url\" + siteId).val();\n        var data = {\n                title: current.title,\n                site_id: siteId,\n                parent_id: current.parent_id,\n                content_id: current.id,\n                entity_id: current.entity_id,\n                url: current.url\n        };\n        if (confirm(bcI18n.contentsEditConfirmMessage4.sprintf(displayName))) {\n            $.bcToken.check(function () {\n                return $.ajax({\n                    url: $.bcUtil.apiAdminBaseUrl + 'baser-core/contents/is_unique_content',\n                    headers: {\n                        \"Authorization\": $.bcJwt.accessToken,\n                    },\n                    type: 'POST',\n                    data: {\n                        url: targetUrl,\n                        _csrfToken: $.bcToken.key,\n                    },\n                    beforeSend: function () {\n                        $.bcUtil.showLoader();\n                    },\n                    success: function (result) {\n                        if (result) {\n                            $.bcToken.key = null;\n                            $.bcToken.check(function () {\n                                return $.ajax({\n                                    url: bcManageContent[current.type]['url']['copy'],\n                                    headers: {\n                                        \"Authorization\": $.bcJwt.accessToken,\n                                    },\n                                    type: 'POST',\n                                    data: $.extend(data, {\n                                        _csrfToken: $.bcToken.key,\n                                    }),\n                                    dataType: 'json',\n                                    beforeSend: function () {\n                                        $(\"#Waiting\").show();\n                                    },\n                                    success: function (result) {\n                                        $.bcUtil.hideLoader();\n                                        location.hash = '#Page';\n                                        $.bcUtil.showNoticeMessage(bcI18n.contentsEditInfoMessage2);\n                                        location.href = bcManageContent[current.type]['url']['edit'] + '/' + result.content.entity_id;\n                                    },\n                                    error: function (XMLHttpRequest, textStatus, errorThrown) {\n                                        $.bcUtil.hideLoader();\n                                        $.bcToken.key = null;\n                                        $.bcUtil.showAlertMessage(bcI18n.contentsEditAlertMessage4);\n                                    }\n                                });\n                            }, {useUpdate: false, hideLoader: false});\n                        } else {\n                            $.bcUtil.hideLoader();\n                            $.bcUtil.showAlertMessage(bcI18n.contentsEditAlertMessage3);\n                        }\n                    },\n                    error: function (XMLHttpRequest, textStatus, errorThrown) {\n                        $.bcUtil.hideLoader();\n                        $.bcUtil.showAlertMessage(bcI18n.contentsEditAlertMessage4);\n                    }\n                });\n            }, {useUpdate: false, hideLoader: false});\n        }\n        return false;\n    });\n\n    if (!$(\"#pages-content-modified-date\").val()) {\n        $(\"#pages-content-modified-date\").val($.bcTimeUtil.getNowDate());\n        $(\"#pages-content-modified-date-time\").val($.bcTimeUtil.getNowTime());\n    }\n\n});\n"],"names":["$","window","setTimeout","scrollTo","fullUrl","attr","previewurlBase","current","parseJSON","bcManageContent","tabs","show","click","bcUtil","showLoader","open","form","this","parents","action","previewMode","val","previewurl","match","submit","get","baseUrl","result","message","bcI18n","contentsEditConfirmMessage1","contentsEditConfirmMessage2","confirm","prop","adminBaseUrl","siteId","displayName","targetUrl","data","content","title","name","plugin","type","site_id","alias_id","id","entity_id","url","contentsEditConfirmMessage3","sprintf","bcToken","check","ajax","apiAdminBaseUrl","headers","bcJwt","accessToken","_csrfToken","key","beforeSend","success","extend","dataType","hideLoader","location","hash","showNoticeMessage","contentsEditInfoMessage1","href","error","XMLHttpRequest","textStatus","errorThrown","showAlertMessage","contentsEditAlertMessage1","useUpdate","contentsEditAlertMessage2","parent_id","content_id","contentsEditConfirmMessage4","contentsEditInfoMessage2","contentsEditAlertMessage4","contentsEditAlertMessage3","bcTimeUtil","getNowDate","getNowTime"],"sourceRoot":""}
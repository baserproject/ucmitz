{"version":3,"file":"admin/uploader_files/uploader_list.bundle.js","mappings":";;;;;;;;;AAaAA,GAAE,WAEE,IAAIC,EAASD,EAAE,WAAWE,OAM1BF,EAAE,WAAWG,SAEb,IAAIC,EAAYJ,EAAE,IAAIK,IAAIL,EAAE,UAAUK,IAAIL,EAAE,SACxCM,EAAUN,EAAEM,UAAY,IACxBC,EAAcP,EAAE,gBAAgBE,OAChCM,EAAa,KAqGjB,SAASC,IAEL,IAAIC,EAAMJ,EAAUC,EAAc,uCAC9BI,EAAOX,EAAEY,MACbZ,EAAE,YAAYa,OAEVb,EAAE,oBAAsBC,GAAQa,OAChCd,EAAEe,QAAQC,OAAM,WACZ,IAAIC,EAAO,CAAC,WAAcjB,EAAEe,QAAQG,KAChClB,EAAE,kCAAoCC,GAAQkB,SAC9CF,EAAOjB,EAAEoB,OAAOH,EAAM,CAAC,2CAA4CjB,EAAE,kCAAoCC,GAAQa,SAErHH,EAAKU,OAAOX,EAAKO,EAAMK,EAAsB,OAChD,GAAE,CAACC,WAAW,EAAOC,YAAY,GAIzC,CAKD,SAASF,EAAqBG,GAEtBA,GACIzB,EAAE,kCAAoCC,GAAQkB,SAC9CnB,EAAE,4BAA8BC,GAAQa,IAAId,EAAE,kCAAoCC,GAAQa,OAC1FN,EAAaR,EAAE,kCAAoCC,GAAQa,OAE/DY,MAEA1B,EAAE,iBAAiBG,SACnBH,EAAE,YAAcC,GAAQ0B,QAAQ,wCAA0CC,OAAOC,sBAAwB,QACzG7B,EAAE,YAAY8B,QAKlB9B,EAAE,oBAAsBC,GAAQE,SAChCH,EAAE,kBAAoBC,GAAQ8B,OAAO,8BAAgC9B,EAAS,wFAC9ED,EAAE,oBAAsBC,GAAQ+B,OAAOvB,GACvCT,EAAEe,QAAQG,IAAM,IAEnB,CAKD,SAASQ,IAgLT,IAEQO,EAjLJjC,EAAEkC,OAAOC,MAiLLF,EAAUjC,EAAE,WAAaC,GAAQmC,KAAK,QACtCpC,EAAE,4BAA8BC,GAAQkB,SACxCc,GAAW,yBAA2BjC,EAAE,4BAA8BC,GAAQa,OAE9Ed,EAAE,qDAAqDmB,SACvDc,GAAW,kBAAoBjC,EAAE,qDAAqDc,OAEtFd,EAAE,cAAgBC,GAAQa,QAC1BmB,GAAW,SAAWI,UAAUrC,EAAE,cAAgBC,GAAQa,QAEvDmB,GA3LqBK,EAA8B,CAACd,YAAY,EAAOe,KAAM,OACvF,CAQD,SAASC,EAAmBC,GACxB,IAAIC,EAAc1C,EAAE,gBAAgBE,OAChCyC,EAAmB3C,EAAE,qBAAqBE,OAC1C0C,EAAgBC,OAAO7C,EAAE,kBAAkBE,QAC3C4C,GAAW,EAMf,OALwB,GAApBH,GAAyBC,GACrBF,GAAeD,IACfK,GAAW,GAGZA,CACV,CA+ID,SAASR,EAA6BS,GAElC/C,EAAE,YAAcC,GAAQC,KAAK6C,GA5IjC,WAEwB/C,EAAE,kBAAkBE,OAEpCM,GACAR,EAAE,kCAAoCC,GAAQa,IAAIN,GAGtDR,EAAE,oBAAoBgD,OAAO,qBAC7BhD,EAAE,oBAAoBgD,OAAO,0BAC7BhD,EAAE,oBAAoBgD,OAAO,0BAC7BhD,EAAE,mBAAmBgD,OAAO,yBAC5BhD,EAAE,oBAAoBgD,OAAO,0BAC7BhD,EAAE,mBAAmBgD,OAAO,qBAC5BhD,EAAE,eAAegD,OAAO,SAGxB,IAAIC,EAA2B,OAE3BjD,EAAEkD,GAAGC,cAAgBlD,GAAUD,EAAE,iBAAiBmB,QAElDnB,EAAE,iBAAiBmD,YAAY,CAC3BC,SAAU,mBACVC,SAAUC,EACVC,MAAO,SAAUC,EAAUC,GACvB,IAAIX,EAAWN,EAAmBxC,EAAEwD,GAAUE,KAAK,YAAYxD,QAC/D,MAAO,CACHyD,MAAO,CACHC,KAAM,CACFC,KAAMjC,OAAOkC,aACbC,KAAM,OACNjB,SAAU,SAAU5B,EAAK8C,GACrB,OAAOlB,CACV,GAELmB,OAAQ,CACJJ,KAAMjC,OAAOsC,eACbH,KAAM,SACNjB,SAAU,SAAU5B,EAAK8C,GACrB,OAAOlB,CACV,IAIhB,IAIT9C,EAAE,kCAAkCmE,MAAK,WAEjCnE,EAAEkD,GAAGC,cAAgBlD,EAChBuC,EAAmBxC,EAAEY,MAAM8C,KAAK,YAAYxD,QAK7CF,EAAEY,MAAMwD,KAAK,0BAA0B,WACnCC,MAAMzC,OAAO0C,sBAChB,IANDtE,EAAEY,MAAMwD,KAAK,0BAA0B,WACnCpE,EAAE,eAAeuE,OAAO,OAC3B,IAOLvE,EAAEY,MAAMwD,KAAK,eAAe,SAAUX,GAClC,OAAO,CACV,IAIDzD,EAAEY,MAAM4D,SAAS,cACjBxE,EAAEY,MAAM6D,IAAI,mBAAoBxB,EAEvC,IAGDjD,EAAE,oBAAsBC,GAAQ+B,OAAOvB,GAEnCR,GACAD,EAAE,oBAAoBoE,KAAK,0BAA0B,WACjDpE,EAAEY,MAAM6D,IAAI,mBAAoB,UACnC,IACDzE,EAAE,oBAAoBoE,KAAK,0BAA0B,WACjDpE,EAAEY,MAAM6D,IAAI,mBAAoB,WAC5BzE,EAAEY,MAAM4D,SAAS,cACjBxE,EAAEY,MAAM6D,IAAI,mBAAoBxB,EAEvC,IACDjD,EAAE,oBAAoBmE,MAAK,WAEvBnE,EAAEY,MAAMwD,KAAK,aAAa,WACtBpE,EAAE,oBAAoB0E,YAAY,YAClC1E,EAAEY,MAAM+D,SAAS,WACpB,GACJ,MAED3E,EAAE,kCAAkCoE,KAAK,0BAA0B,WAC/DpE,EAAEY,MAAM6D,IAAI,mBAAoB,UACnC,IACDzE,EAAE,kCAAkCoE,KAAK,0BAA0B,WAC/DpE,EAAEY,MAAM6D,IAAI,mBAAoB,WAC5BzE,EAAEY,MAAM4D,SAAS,cACjBxE,EAAEY,MAAM6D,IAAI,mBAAoBxB,EAEvC,IACDjD,EAAE,kCAAkCmE,MAAK,WAErCnE,EAAEY,MAAMwD,KAAK,aAAa,WACtBpE,EAAE,oBAAoB0E,YAAY,YAClC1E,EAAEY,MAAM+D,SAAS,WACpB,GACJ,KAIL3E,EAAE,mBAAmBoE,KAAK,yBAAyB,WAG/C,OAFApE,EAAE,YAAYa,OACdb,EAAE4E,IAAI5E,EAAEY,MAAMwB,KAAK,QAASE,IACrB,CACV,IAEDtC,EAAE,aAAeC,GAAQmE,KAAK,qBAAqB,WAC/C1C,GACH,IAUD1B,EAAE,YAAcC,GAAQ4E,QAAQ,gBAChC7E,EAAE,YAAcC,GAAQ6E,OAAO,YAAa,CAAC,EAAG,KAEnD,CAQGC,GACA/E,EAAE,YAAcC,GAAQ4E,QAAQ,qBAChC7E,EAAE,YAAY8B,MAEjB,CAwBD,SAASwB,EAAkB0B,EAAQC,EAAIC,GAEnC,IAAIC,EAAS7E,EAAUC,EAAc,mCAAqCP,EAAE,YAAcC,EAAS,kBAAkBC,OASrH,QAJY,IAFRgF,EAAMF,EAAOI,QAAQ,QAGrBJ,EAASA,EAAOK,UAAUH,EAAM,EAAGF,EAAO7D,SAGtC6D,GAEJ,IAAK,OACDhF,EAAE,eAAeuE,OAAO,QACxB,MAEJ,IAAK,SACGe,QAAQ1D,OAAO2D,0BACfvF,EAAEe,QAAQC,OAAM,WAEZ,OADAhB,EAAE,YAAYa,OACPb,EAAEkC,OAAOC,KAAKgD,GAAQ,SAAU1D,GAC9BA,GAIDzB,EAAE,YAAcC,GAAQ4E,QAAQ,kBAChCnD,MAJA1B,EAAE,YAAY8B,OACduC,MAAMzC,OAAO4D,wBAKjBxF,EAAEe,QAAQG,IAAM,IACnB,GAAE,CACCD,KAAM,CACFwE,OAAQ,CAACvE,IAAKlB,EAAEe,QAAQG,MACzBM,YAAY,GAEtB,GAAE,CAACD,WAAW,EAAOC,YAAY,IAKjD,CA7XDE,IAGA1B,EAAE,eAAeuE,OAAO,CACpBmB,UAAU,EACVC,UAAU,EACVC,SAAU,CAACC,GAAI,gBAAiBC,GAAIC,QACpCC,MAAO,IACPC,OAAO,EACPC,KAAM,WACF,IAAIrC,EAAO7D,EAAE,YAAcC,EAAS,oBAAoBC,OACpDiG,EAAS7F,EAAUC,EAAc,uCAAyCsD,EAAO,UACrF7D,EAAE,kBAAoBC,GAAQa,IAAId,EAAE,YAAcC,EAAS,kBAAkBC,QAC7EF,EAAE,oBAAsBC,GAAQa,IAAI+C,GACpC7D,EAAE,mBAAqBC,GAAQa,IAAId,EAAE,YAAcC,EAAS,mBAAmBC,QAG/E,IAAIkG,EAAmBpG,EAAE,YAAcC,EAAS,6BAA6BC,OACzEmG,EAAmBrG,EAAE,YAAcC,EAAS,kCAAkCC,OAClFF,EAAE,iCAAiCc,IAAIsF,GACvCpG,EAAE,iCAAiCc,IAAIuF,GACvC,IAAIC,EAAuBF,EACvBC,IACAC,GAAwB,IAAMD,GAElCrG,EAAE,6BAA6Bc,IAAIwF,GAGnC,IAAIC,EAAiBvG,EAAE,YAAcC,EAAS,2BAA2BC,OACrEsG,EAAiBxG,EAAE,YAAcC,EAAS,gCAAgCC,OAC9EF,EAAE,+BAA+Bc,IAAIyF,GACrCvG,EAAE,+BAA+Bc,IAAI0F,GACrC,IAAIC,EAAqBF,EACrBC,IACAC,GAAsB,IAAMD,GAEhCxG,EAAE,2BAA2Bc,IAAI2F,GAEjCzG,EAAE,sBAAwBC,GAAQa,IAAId,EAAE,YAAcC,EAAS,uBAAuBC,QACtFF,EAAE,wBAA0BC,GAAQC,KAAKF,EAAE,YAAcC,EAAS,yBAAyBC,QACvFF,EAAE,mCAAqCC,GAAQkB,QAC/CnB,EAAE,mCAAqCC,GAAQa,IAAId,EAAE,YAAcC,EAAS,oCAAoCC,QAEpHF,EAAE4E,IAAIuB,GAAQ,SAAU1E,GACpBzB,EAAE,qBAAuBC,GAAQC,KAAKuB,EACzC,GACJ,EACDiF,QAAS,CACLC,OAAQ,CACJC,KAAMhF,OAAOiF,eACbC,MAAO,WACH9G,EAAEY,MAAM2D,OAAO,SACfvE,EAAE,qBAAuBC,GAAQC,KAAK,aAAeI,EAAU,gCAClE,GAELyG,KAAM,CACFH,KAAMhF,OAAOoF,aACbF,MAAO,WAEH,IAAIG,EAAajH,EAAEY,MACnBZ,EAAEe,QAAQC,OAAM,WAEZ,IAAIC,EAAO,CACP,yBAA0BjB,EAAE,kBAAoBC,GAAQa,MACxD,2BAA4Bd,EAAE,oBAAsBC,GAAQa,MAC5D,0BAA2Bd,EAAE,mBAAqBC,GAAQa,MAC1D,oCAAqCd,EAAE,4BAA8BC,GAAQa,MAC7E,kCAAmCd,EAAE,0BAA4BC,GAAQa,MACzE,8BAA+Bd,EAAE,sBAAwBC,GAAQa,MACjE,2CAA4Cd,EAAE,mCAAqCC,GAAQa,MAC3F,WAAcd,EAAEe,QAAQG,KAE5B,OAAOlB,EAAEkC,OAAOC,KAAKnC,EAAE,wBAA0BC,GAAQmC,KAAK,WAAW,SAAUX,GAC3EA,GACAC,IACAtB,EAAUsE,YAAY,kBACtBuC,EAAW1C,OAAO,SAClBvE,EAAE,qBAAuBC,GAAQC,KAAK,aAAeI,EAAU,mCAE/DN,EAAEkC,OAAOV,aACT6C,MAAMzC,OAAOsF,wBAEjBlH,EAAEe,QAAQG,IAAM,IACnB,GAAE,CAACD,KAAMA,GACb,GAAE,CAACO,YAAY,EAAOD,WAAW,GACrC,IAGT4F,MAAO,WACH/G,EAAUU,IAAI,IAAI4D,YAAY,kBAC9B1E,EAAE,qBAAuBC,GAAQC,KAAK,aAAeI,EAAU,gCAClE,GAqSR","sources":["webpack://bc-uploader/./src/js/admin/uploader_files/uploader_list.js"],"sourcesContent":["/**\n * baserCMS :  Based Website Development Project <https://basercms.net>\n * Copyright (c) NPO baser foundation <https://baserfoundation.org/>\n *\n * @copyright     Copyright (c) NPO baser foundation\n * @link          https://basercms.net baserCMS Project\n * @since         5.0.0\n * @license       https://basercms.net/license/index.html MIT License\n */\n\n/**\n * 起動時処理\n */\n$(function () {\n\n    var listId = $(\"#ListId\").html();\n\n    //==========================================================================\n    // 複数のエディタよりリストが呼出される可能性がある為、#ListIdの値を読み込んだら削除する\n    // TODO 強引すぎるので他の方法がないか検討要\n    //==========================================================================\n    $(\"#ListId\").remove();\n\n    var allFields = $([]).add($(\"#name\")).add($(\"#alt\"));\n    var baseUrl = $.baseUrl() + '/';\n    var adminPrefix = $(\"#AdminPrefix\").html();\n    var categoryId = null;\n\n    // 一覧を更新する\n    updateFileList();\n\n    /* ダイアログを初期化 */\n    $(\"#EditDialog\").dialog({\n        bgiframe: true,\n        autoOpen: false,\n        position: {at: \"center center\", of: window},\n        width: 960,\n        modal: true,\n        open: function () {\n            var name = $(\"#FileList\" + listId + \" .selected .name\").html();\n            var imgUrl = baseUrl + adminPrefix + '/uploader/uploader_files/ajax_image/' + name + '/midium';\n            $(\"#UploaderFileId\" + listId).val($(\"#FileList\" + listId + \" .selected .id\").html());\n            $(\"#UploaderFileName\" + listId).val(name);\n            $(\"#UploaderFileAlt\" + listId).val($(\"#FileList\" + listId + \" .selected .alt\").html());\n\n            /* ダイアログ初期化時、hidden値が空になるため公開期間開始日時を取得して hidden値に入れ込む */\n            var publishBeginDate = $(\"#FileList\" + listId + \" .selected .publish-begin\").html();\n            var publishBeginTime = $(\"#FileList\" + listId + \" .selected .publish-begin-time\").html();\n            $(\"#UploaderFilePublishBeginDate\").val(publishBeginDate);\n            $(\"#UploaderFilePublishBeginTime\").val(publishBeginTime);\n            var publishBeginDateTime = publishBeginDate;\n            if (publishBeginTime) {\n                publishBeginDateTime += ' ' + publishBeginTime;\n            }\n            $(\"#UploaderFilePublishBegin\").val(publishBeginDateTime);\n\n            /* ダイアログ初期化時、hidden値が空になるため公開期間終了日時を取得して hidden値に入れ込む */\n            var publishEndDate = $(\"#FileList\" + listId + \" .selected .publish-end\").html();\n            var publishEndTime = $(\"#FileList\" + listId + \" .selected .publish-end-time\").html();\n            $(\"#UploaderFilePublishEndDate\").val(publishEndDate);\n            $(\"#UploaderFilePublishEndTime\").val(publishEndTime);\n            var publishEndDateTime = publishEndDate;\n            if (publishEndTime) {\n                publishEndDateTime += ' ' + publishEndTime;\n            }\n            $(\"#UploaderFilePublishEnd\").val(publishEndDateTime);\n\n            $(\"#UploaderFileUserId\" + listId).val($(\"#FileList\" + listId + \" .selected .user-id\").html());\n            $(\"#UploaderFileUserName\" + listId).html($(\"#FileList\" + listId + \" .selected .user-name\").html());\n            if ($(\"#_UploaderFileUploaderCategoryId\" + listId).length) {\n                $(\"#_UploaderFileUploaderCategoryId\" + listId).val($(\"#FileList\" + listId + \" .selected .uploader-category-id\").html());\n            }\n            $.get(imgUrl, function (res) {\n                $(\"#UploaderFileImage\" + listId).html(res);\n            });\n        },\n        buttons: {\n            cancel: {\n                text: bcI18n.uploaderCancel,\n                click: function () {\n                    $(this).dialog('close');\n                    $(\"#UploaderFileImage\" + listId).html('<img src=\"' + baseUrl + 'img/admin/ajax-loader.gif\" />');\n                }\n            },\n            save: {\n                text: bcI18n.uploaderSave,\n                click: function () {\n                    // 保存処理\n                    var saveButton = $(this);\n                    $.bcToken.check(function () {\n                        // IEでform.serializeを利用した場合、Formタグの中にTableタグがあるとデータが取得できなかった\n                        var data = {\n                            \"data[UploaderFile][id]\": $(\"#UploaderFileId\" + listId).val(),\n                            \"data[UploaderFile][name]\": $(\"#UploaderFileName\" + listId).val(),\n                            \"data[UploaderFile][alt]\": $(\"#UploaderFileAlt\" + listId).val(),\n                            \"data[UploaderFile][publish_begin]\": $(\"#UploaderFilePublishBegin\" + listId).val(),\n                            \"data[UploaderFile][publish_end]\": $(\"#UploaderFilePublishEnd\" + listId).val(),\n                            \"data[UploaderFile][user_id]\": $(\"#UploaderFileUserId\" + listId).val(),\n                            \"data[UploaderFile][uploader_category_id]\": $(\"#_UploaderFileUploaderCategoryId\" + listId).val(),\n                            \"_csrfToken\": $.bcToken.key\n                        };\n                        return $.bcUtil.ajax($(\"#UploaderFileEditForm\" + listId).attr('action'), function (res) {\n                            if (res) {\n                                updateFileList();\n                                allFields.removeClass('ui-state-error');\n                                saveButton.dialog('close');\n                                $(\"#UploaderFileImage\" + listId).html('<img src=\"' + baseUrl + 'img/admin/ajax-loader.gif\" />');\n                            } else {\n                                $.bcUtil.hideLoader();\n                                alert(bcI18n.uploaderAlertMessage1);\n                            }\n                            $.bcToken.key = null;\n                        }, {data: data});\n                    }, {hideLoader: false, useUpdate: false});\n                }\n            }\n        },\n        close: function () {\n            allFields.val('').removeClass('ui-state-error');\n            $(\"#UploaderFileImage\" + listId).html('<img src=\"' + baseUrl + 'img/admin/ajax-loader.gif\" />');\n        }\n\n    });\n\n    /**\n     * アップロードファイル選択時イベント\n     */\n    function uploaderFileFileChangeHandler() {\n\n        var url = baseUrl + adminPrefix + '/uploader/uploader_files/ajax_upload';\n        var form = $(this);\n        $(\"#Waiting\").show();\n\n        if ($('#UploaderFileFile' + listId).val()) {\n            $.bcToken.check(function () {\n                var data = {'_csrfToken': $.bcToken.key};\n                if ($(\"#UploaderFileUploaderCategoryId\" + listId).length) {\n                    data = $.extend(data, {'data[UploaderFile][uploader_category_id]': $(\"#UploaderFileUploaderCategoryId\" + listId).val()});\n                }\n                form.upload(url, data, uploadSuccessHandler, 'html');\n            }, {useUpdate: false, hideLoader: false});\n\n        }\n\n    }\n\n    /**\n     * アップロード完了後イベント\n     */\n    function uploadSuccessHandler(res) {\n\n        if (res) {\n            if ($('#UploaderFileUploaderCategoryId' + listId).length) {\n                $('#FilterUploaderCategoryId' + listId).val($('#UploaderFileUploaderCategoryId' + listId).val());\n                categoryId = $('#UploaderFileUploaderCategoryId' + listId).val();\n            }\n            updateFileList();\n        } else {\n            $('#ErrorMessage').remove();\n            $('#FileList' + listId).prepend('<p id=\"ErrorMessage\" class=\"message\">' + bcI18n.uploaderAlertMessage2 + '</p>');\n            $(\"#Waiting\").hide();\n        }\n        // フォームを初期化\n        // セキュリティ上の関係でvalue値を直接消去する事はできないので、一旦エレメントごと削除し、\n        // spanタグ内に新しく作りなおす。\n        $(\"#UploaderFileFile\" + listId).remove();\n        $(\"#SpanUploadFile\" + listId).append('<input id=\"UploaderFileFile' + listId + '\" type=\"file\" value=\"\" name=\"data[UploaderFile][file]\" class=\"uploader-file-file\" />');\n        $('#UploaderFileFile' + listId).change(uploaderFileFileChangeHandler);\n        $.bcToken.key = null;\n\n    }\n\n    /**\n     * 一覧を更新する\n     */\n    function updateFileList() {\n        $.bcUtil.ajax(getListUrl(), updateFileListCompleteHander, {hideLoader: false, type: 'GET'});\n    }\n\n    /**\n     * 指定したファイルの編集ができない状態か確認\n     *\n     * @param fileUserId\n     * @returns {boolean}\n     */\n    function isFileEditDisabled(fileUserId) {\n        var loginUserId = $(\"#LoginUserId\").html();\n        var loginUserGroupId = $(\"#LoginUserGroupId\").html();\n        var usePermission = Number($(\"#UsePermission\").html());\n        var disabled = false;\n        if (loginUserGroupId != 1 && usePermission) {\n            if (loginUserId != fileUserId) {\n                disabled = true;\n            }\n        }\n        return disabled;\n    }\n\n    /**\n     * 選択イベントを初期化する\n     */\n    function initFileList() {\n\n        var usePermission = $(\"#UsePermission\").html();\n\n        if (categoryId) {\n            $('#UploaderFileUploaderCategoryId' + listId).val(categoryId);\n        }\n        /* 一旦イベントを全て解除 */\n        $(\".selectable-file\").unbind('click.selectEvent');\n        $(\".selectable-file\").unbind('mouseenter.selectEvent');\n        $(\".selectable-file\").unbind('mouseleave.selectEvent');\n        $(\".page-numbers a\").unbind('click.paginationEvent');\n        $(\".selectable-file\").unbind('dblclick.dblclickEvent');\n        $(\".filter-control\").unbind('click.filterEvent');\n        $(\".btn-delete\").unbind('click');\n\n        /* 公開制限期間にあるファイルの背景色を定義 */\n        var unpublishBackGroundColor = '#bbb';\n\n        if ($.fn.contextMenu && !listId && $(\"#DivPanelList\").length) {\n            /* 右クリックメニューを追加 */\n            $(\"#DivPanelList\").contextMenu({\n                selector: '.selectable-file',\n                callback: contextMenuHander,\n                build: function ($trigger, e) {\n                    var disabled = isFileEditDisabled($($trigger).find('.user-id').html());\n                    return {\n                        items: {\n                            edit: {\n                                name: bcI18n.uploaderEdit,\n                                icon: 'edit',\n                                disabled: function (key, opt) {\n                                    return disabled;\n                                }\n                            },\n                            delete: {\n                                name: bcI18n.uploaderDelete,\n                                icon: 'delete',\n                                disabled: function (key, opt) {\n                                    return disabled;\n                                }\n                            }\n                        }\n                    }\n                }\n            });\n        }\n\n        $(\"#DivPanelList .selectable-file\").each(function () {\n\n            if ($.fn.contextMenu && !listId) {\n                if (!isFileEditDisabled($(this).find('.user-id').html())) {\n                    $(this).bind('dblclick.dblclickEvent', function () {\n                        $('#EditDialog').dialog('open');\n                    });\n                } else {\n                    $(this).bind('dblclick.dblclickEvent', function () {\n                        alert(bcI18n.uploaderAlertMessage3);\n                    });\n                }\n            } else {\n                $(this).bind(\"contextmenu\", function (e) {\n                    return false;\n                });\n            }\n\n            /* 公開制限期間にあるファイルは背景色をグレーにする */\n            if ($(this).hasClass('unpublish')) {\n                $(this).css('background-color', unpublishBackGroundColor);\n            }\n        });\n\n        // ファイルアップロードイベントを登録\n        $('#UploaderFileFile' + listId).change(uploaderFileFileChangeHandler);\n\n        if (listId) {\n            $(\".selectable-file\").bind('mouseenter.selectEvent', function () {\n                $(this).css('background-color', '#FFCC00');\n            });\n            $(\".selectable-file\").bind('mouseleave.selectEvent', function () {\n                $(this).css('background-color', '#FFFFFF');\n                if ($(this).hasClass('unpublish')) {\n                    $(this).css('background-color', unpublishBackGroundColor);\n                }\n            });\n            $(\".selectable-file\").each(function () {\n                // IEの場合contextmenuを検出できなかったので、mousedownに変更した\n                $(this).bind('mousedown', function () {\n                    $(\".selectable-file\").removeClass('selected');\n                    $(this).addClass('selected');\n                });\n            });\n        } else {\n            $(\"#DivPanelList .selectable-file\").bind('mouseenter.selectEvent', function () {\n                $(this).css('background-color', '#FFCC00');\n            });\n            $(\"#DivPanelList .selectable-file\").bind('mouseleave.selectEvent', function () {\n                $(this).css('background-color', '#FFFFFF');\n                if ($(this).hasClass('unpublish')) {\n                    $(this).css('background-color', unpublishBackGroundColor);\n                }\n            });\n            $(\"#DivPanelList .selectable-file\").each(function () {\n                // IEの場合contextmenuを検出できなかったので、mousedownに変更した\n                $(this).bind('mousedown', function () {\n                    $(\".selectable-file\").removeClass('selected');\n                    $(this).addClass('selected');\n                });\n            });\n        }\n\n        /* ページネーションイベントを追加 */\n        $('.page-numbers a').bind('click.paginationEvent', function () {\n            $(\"#Waiting\").show();\n            $.get($(this).attr('href'), updateFileListCompleteHander);\n            return false;\n        });\n\n        $(\"#BtnFilter\" + listId).bind('click.filterEvent', function () {\n            updateFileList();\n        });\n        /*$('#FilterUploaderCategoryId'+listId).bind('change.filterEvent', function() {\n            $(\"#Waiting\").show();\n            $.get(getListUrl(),updateFileListCompleteHander);\n        });\n        $('input[name=\"data[Filter][uploader_type]\"]').bind('click.filterEvent', function() {\n            $(\"#Waiting\").show();\n            $.get(getListUrl(),updateFileListCompleteHander);\n        });*/\n\n        $(\"#FileList\" + listId).trigger(\"filelistload\");\n        $(\"#FileList\" + listId).effect(\"highlight\", {}, 1500);\n\n    }\n\n    /**\n     * ファイルリスト取得完了イベント\n     */\n    function updateFileListCompleteHander(result) {\n\n        $(\"#FileList\" + listId).html(result);\n        initFileList();\n        $(\"#FileList\" + listId).trigger('loadTableComplete');\n        $(\"#Waiting\").hide();\n\n    }\n\n    /**\n     * Ajax List 取得用のURLを取得する\n     */\n    function getListUrl() {\n\n        var listUrl = $(\"#ListUrl\" + listId).attr('href');\n        if ($('#FilterUploaderCategoryId' + listId).length) {\n            listUrl += '/uploader_category_id:' + $('#FilterUploaderCategoryId' + listId).val();\n        }\n        if ($('input[name=\"data[Filter][uploader_type]\"]:checked').length) {\n            listUrl += '/uploader_type:' + $('input[name=\"data[Filter][uploader_type]\"]:checked').val();\n        }\n        if ($('#FilterName' + listId).val()) {\n            listUrl += '/name:' + encodeURI($('#FilterName' + listId).val());\n        }\n        return listUrl;\n\n    }\n\n    /**\n     * コンテキストメニューハンドラ\n     */\n    function contextMenuHander(action, el, pos) {\n\n        var delUrl = baseUrl + adminPrefix + '/uploader/uploader_files/delete/' + $(\"#FileList\" + listId + \" .selected .id\").html();\n\n        // IEの場合、action値が正常に取得できないので整形する\n        var pos = action.indexOf(\"#\");\n\n        if (pos != -1) {\n            action = action.substring(pos + 1, action.length);\n        }\n\n        switch (action) {\n\n            case 'edit':\n                $('#EditDialog').dialog('open');\n                break;\n\n            case 'delete':\n                if (confirm(bcI18n.uploaderConfirmMessage1)) {\n                    $.bcToken.check(function () {\n                        $(\"#Waiting\").show();\n                        return $.bcUtil.ajax(delUrl, function (res) {\n                            if (!res) {\n                                $(\"#Waiting\").hide();\n                                alert(bcI18n.uploaderAlertMessage4);\n                            } else {\n                                $(\"#FileList\" + listId).trigger(\"deletecomplete\");\n                                updateFileList();\n                            }\n                            $.bcToken.key = null;\n                        }, {\n                            data: {\n                                _Token: {key: $.bcToken.key}\n                            }, hideLoader: false\n                        });\n                    }, {useUpdate: false, hideLoader: false});\n                }\n                break;\n        }\n\n    }\n\n\n});\n"],"names":["$","listId","html","remove","allFields","add","baseUrl","adminPrefix","categoryId","uploaderFileFileChangeHandler","url","form","this","show","val","bcToken","check","data","key","length","extend","upload","uploadSuccessHandler","useUpdate","hideLoader","res","updateFileList","prepend","bcI18n","uploaderAlertMessage2","hide","append","change","listUrl","bcUtil","ajax","attr","encodeURI","updateFileListCompleteHander","type","isFileEditDisabled","fileUserId","loginUserId","loginUserGroupId","usePermission","Number","disabled","result","unbind","unpublishBackGroundColor","fn","contextMenu","selector","callback","contextMenuHander","build","$trigger","e","find","items","edit","name","uploaderEdit","icon","opt","delete","uploaderDelete","each","bind","alert","uploaderAlertMessage3","dialog","hasClass","css","removeClass","addClass","get","trigger","effect","initFileList","action","el","pos","delUrl","indexOf","substring","confirm","uploaderConfirmMessage1","uploaderAlertMessage4","_Token","bgiframe","autoOpen","position","at","of","window","width","modal","open","imgUrl","publishBeginDate","publishBeginTime","publishBeginDateTime","publishEndDate","publishEndTime","publishEndDateTime","buttons","cancel","text","uploaderCancel","click","save","uploaderSave","saveButton","uploaderAlertMessage1","close"],"sourceRoot":""}